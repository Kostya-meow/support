# üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ RAG —Å–∏—Å—Ç–µ–º—ã

## üéØ –î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç

–≠—Ç–æ—Ç –≥–∞–π–¥ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è **ML-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤**, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ç—é–Ω–∏—Ç—å RAG –ø–∞–π–ø–ª–∞–π–Ω: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç—ã, –ø–æ—Ä–æ–≥–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–æ—Ç–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 1Ô∏è‚É£ `.env` - –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
**‚ö†Ô∏è –ù–ï –ö–û–ú–ú–ò–¢–ò–¢–¨ –í GIT!**

–°–æ–¥–µ—Ä–∂–∏—Ç API –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã –∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- `TELEGRAM_BOT_TOKEN` - —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `LLM_API_KEY` / `OPENAI_API_KEY` - –∫–ª—é—á –¥–ª—è LLM API
- `LLM_API_BASE` - –±–∞–∑–æ–≤—ã–π URL (–µ—Å–ª–∏ –Ω–µ OpenAI)
- `SECRET_KEY` - –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ —Å–µ—Å—Å–∏–π
- `SESSION_COOKIE_*` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–º–µ—Ä:**
```bash
LLM_API_KEY=sk-xxxxxxxxxxxxx
LLM_API_BASE=https://api.openai.com/v1
LLM_MODEL=gpt-4o-mini
TELEGRAM_BOT_TOKEN=1234567890:ABCdef...
SECRET_KEY=your-secret-key-here
```

### 2Ô∏è‚É£ `config.yaml` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ RAG —Å–∏—Å—Ç–µ–º—ã
**‚úÖ –ú–û–ñ–ù–û –ö–û–ú–ú–ò–¢–ò–¢–¨**

–°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ç—é–Ω–∏–Ω–≥–∞:
- –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è LLM
- –ü–æ—Ä–æ–≥–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞
- –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–µ–π

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ç—é–Ω–∏–Ω–≥–∞

### üéöÔ∏è –ü–æ—Ä–æ–≥–∏ (Thresholds)

#### 1. `rag.filter_threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1.7)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –§–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ù–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0.5-1.0):** –°—Ç—Ä–æ–∂–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –±–æ–ª—å—à–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- **–í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (2.0-3.0):** –ú—è–≥—á–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –º–µ–Ω—å—à–µ false positives

**–ö–æ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏—Ç—å:**
- –ë–æ—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∂–∞–ª—É—é—Ç—Å—è –Ω–∞ "–∑–∞–ø—Ä–æ—Å –Ω–µ –ø—Ä–æ—à–µ–ª —Ñ–∏–ª—å—Ç—Ä"

**–ö–æ–≥–¥–∞ —É–º–µ–Ω—å—à–∏—Ç—å:**
- –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –æ—Ñ—Ç–æ–ø–∏–∫ (–ø–æ–ª–∏—Ç–∏–∫–∞, –º–µ–¥–∏—Ü–∏–Ω–∞)
- –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (prompt injection)

#### 2. `rag.output_threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1.7)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞.
- **–ù–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–æ–ª—å—à–µ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è
- **–í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–æ—Ç —á–∞—â–µ –¥–∞–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞–ø—Ä—è–º—É—é

**–ö–æ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏—Ç—å:**
- –ë–æ—Ç —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç "–Ω–µ –º–æ–≥—É –æ—Ç–≤–µ—Ç–∏—Ç—å"
- –•–æ—Ä–æ—à–∏–µ –æ—Ç–≤–µ—Ç—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è

**–ö–æ–≥–¥–∞ —É–º–µ–Ω—å—à–∏—Ç—å:**
- –ë–æ—Ç –¥–∞–µ—Ç –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- –û—Ç–≤–µ—á–∞–µ—Ç –Ω–µ –ø–æ —Ç–µ–º–µ IT-–ø–æ–¥–¥–µ—Ä–∂–∫–∏

#### 3. `rag.operator_threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.8)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –ø—Ä–æ—Å–∏—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
- **–ù–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0.5-0.7):** –ß–∞—â–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- **–í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0.9-1.0):** –†–µ–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

**–ö–æ–≥–¥–∞ —É–º–µ–Ω—å—à–∏—Ç—å:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —è–≤–Ω–æ –ø—Ä–æ—Å—è—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –Ω–æ –±–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç
- –ú–Ω–æ–≥–æ —ç—Å–∫–∞–ª–∞—Ü–∏–π –≤—Ä—É—á–Ω—É—é

**–ö–æ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏—Ç—å:**
- –ë–æ—Ç —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- –ù–∞ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å —Ç–∏–ø–∞ "–ø–æ–º–æ–≥–∏—Ç–µ" —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

#### 4. `toxicity.threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.8)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–æ–∫—Å–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
- **–ù–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0.6-0.7):** –°—Ç—Ä–æ–∂–µ –º–æ–¥–µ—Ä–∞—Ü–∏—è
- **–í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (0.9):** –ú—è–≥—á–µ –º–æ–¥–µ—Ä–∞—Ü–∏—è

---

### üîç –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ (Retrieval)

#### `rag.top_n` –∏ `rag.top_m` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ FAISS (semantic) –∏ BM25 (keyword).

**–ö–æ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏—Ç—å (70-100):**
- –ë–æ—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –±–æ–ª—å—à–∞—è (>1000 –∑–∞–ø–∏—Å–µ–π)

**–ö–æ–≥–¥–∞ —É–º–µ–Ω—å—à–∏—Ç—å (30-40):**
- –ú–µ–¥–ª–µ–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
- –ü–æ–ø–∞–¥–∞—é—Ç –ª–∏—à–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç

#### `rag.top_n_tokens` –∏ `rag.top_m_tokens` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 250)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ø–æ–∏—Å–∫–∞.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- **–ú–∞–ª—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (200-300):** –ë—ã—Å—Ç—Ä–µ–µ, –¥–µ—à–µ–≤–ª–µ, –Ω–æ –º–æ–∂–µ—Ç –Ω–µ —Ö–≤–∞—Ç–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **–ë–æ–ª—å—à–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (500-1000):** –ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∏ –¥–æ—Ä–æ–∂–µ

#### `rag.history_window` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —É—á–∏—Ç—ã–≤–∞—Ç—å.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- **1-2:** –¢–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å (–±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- **3-5:** –£—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–¥–∞–≤–Ω–∏–π –¥–∏–∞–ª–æ–≥ (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
- **>5:** –ú–æ–∂–µ—Ç –ø—É—Ç–∞—Ç—å—Å—è –≤ –¥–ª–∏–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏

---

### üìù –ü—Ä–æ–º–ø—Ç—ã (Prompts)

#### 1. `rag.persona_prompt` - –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
**–°–∞–º—ã–π –≤–∞–∂–Ω—ã–π!** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∏–ª—å –∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –±–æ—Ç–∞.

**–ß—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å:**
- –¢–æ–Ω –æ–±—â–µ–Ω–∏—è (—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π/–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π)
- –î–ª–∏–Ω–∞ –æ—Ç–≤–µ—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–º–æ–¥–∑–∏
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤ (—Å–ø–∏—Å–∫–∏, –ø—É–Ω–∫—Ç—ã)
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```yaml
persona_prompt: >
  –¢—ã ‚Äî —Å—Ç—Ä–æ–≥–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç. –û—Ç–≤–µ—á–∞–π –∫—Ä–∞—Ç–∫–æ, –±–µ–∑ —ç–º–æ–¥–∑–∏.
  –ò—Å–ø–æ–ª—å–∑—É–π –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç ‚Äî —Å—Ä–∞–∑—É –ø—Ä–µ–¥–ª–∞–≥–∞–π –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
```

#### 2. `rag.filter_prompt` - –§–∏–ª—å—Ç—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
–û—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–π –∑–∞–ø—Ä–æ—Å (0 = –±–µ–∑–æ–ø–∞—Å–Ω–æ, 1 = –æ–ø–∞—Å–Ω–æ).

**–ö–æ–≥–¥–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:**
- –ë–æ—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –æ—Ñ—Ç–æ–ø–∏–∫ ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Ç–µ–º
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã ‚Üí —Å–º—è–≥—á–∏—Ç—å —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏

#### 3. `rag.evaluation_prompt` - –û—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –æ—Ç–≤–µ—Ç —Ç–µ–º–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

**–ö–æ–≥–¥–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:**
- –ë–æ—Ç –¥–∞–µ—Ç –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã ‚Üí —É—Å–∏–ª–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏
- –°–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ ‚Üí —Ä–∞–∑—Ä–µ—à–∏—Ç—å –±–æ–ª—å—à–µ –≥–∏–±–∫–æ—Å—Ç–∏

#### 4. `rag.operator_intent_prompt` - –î–µ—Ç–µ–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –ø—Ä–æ—Å–∏—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ–ª–æ–≤–µ–∫–∞.

**–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç—é–Ω–∏–Ω–≥–∞:**
- –î–æ–±–∞–≤–∏—Ç—å —Å–∏–Ω–æ–Ω–∏–º—ã: "–º–µ–Ω–µ–¥–∂–µ—Ä", "—Å–æ—Ç—Ä—É–¥–Ω–∏–∫", "—Ä–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫"
- –£—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç: "–Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç" ‚Üí –≤—ã—Å–æ–∫–∏–π score

---

## üéõÔ∏è –ú–æ–¥–µ–ª–∏

### Embeddings Model
```yaml
embeddings:
  model_name: "ai-forever/sbert_large_nlu_ru"
  device: "cpu"
```

**–í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞:**
| –ú–æ–¥–µ–ª—å | –ö–∞—á–µ—Å—Ç–≤–æ | –°–∫–æ—Ä–æ—Å—Ç—å | –ü–∞–º—è—Ç—å |
|--------|----------|----------|--------|
| `ai-forever/sbert_large_nlu_ru` | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | üê¢ | 1.5GB |
| `cointegrated/rubert-tiny2` | ‚≠ê‚≠ê‚≠ê | üöÄüöÄ | 200MB |
| `sentence-transformers/all-MiniLM-L6-v2` | ‚≠ê‚≠ê‚≠ê‚≠ê | üöÄ | 400MB |

**–ö–æ–≥–¥–∞ –º–µ–Ω—è—Ç—å:**
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ ‚Üí –≤–∑—è—Ç—å –ª–µ–≥—á–µ –º–æ–¥–µ–ª—å
- –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–∏—Å–∫–∞ ‚Üí –≤–∑—è—Ç—å sbert_large

### LLM Model
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `.env`:
```bash
LLM_MODEL=gpt-4o-mini  # –ë—ã—Å—Ç—Ä–∞—è, –¥–µ—à–µ–≤–∞—è
# –∏–ª–∏
LLM_MODEL=gpt-4o  # –õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ, –¥–æ—Ä–æ–∂–µ
```

---

## üß™ –ü—Ä–æ—Ü–µ—Å—Å —Ç—é–Ω–∏–Ω–≥–∞

### 1. Baseline —Ç–µ—Å—Ç
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python -m app.bot

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã:
# - –û–±—ã—á–Ω—ã–µ IT-–≤–æ–ø—Ä–æ—Å—ã
# - –û—Ñ—Ç–æ–ø–∏–∫ (–ø–æ–ª–∏—Ç–∏–∫–∞, –º–µ–¥–∏—Ü–∏–Ω–∞)
# - –ü—Ä–æ—Å—å–±—ã –æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–µ
# - –¢–æ–∫—Å–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```

### 2. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
tail -f app.log | grep "filter_score"
tail -f app.log | grep "evaluation_score"
tail -f app.log | grep "operator_intent"
```

### 3. –ò—Ç–µ—Ä–∞—Ü–∏—è
1. –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –≤ `config.yaml`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä (–∫–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑)
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ –∂–µ –∑–∞–ø—Ä–æ—Å—ã
4. –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 4. A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```yaml
# –í–µ—Ä—Å–∏—è A (—Å—Ç—Ä–æ–≥–∞—è)
filter_threshold: 1.5
operator_threshold: 0.7

# –í–µ—Ä—Å–∏—è B (–º—è–≥–∫–∞—è)
filter_threshold: 2.0
operator_threshold: 0.85
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–∫–∏

### –ö–∞—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- **False Positive Rate:** % –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–º
- **False Negative Rate:** % –æ—Ñ—Ç–æ–ø–∏–∫–∞/–æ–ø–∞—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–º

### –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
- **Relevance Score:** –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤
- **Operator Escalation Rate:** % –¥–∏–∞–ª–æ–≥–æ–≤, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä—É
- **User Satisfaction:** –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **Response Time:** –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞
- **Token Usage:** –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **Cost per Request:** –°—Ç–æ–∏–º–æ—Å—Ç—å API –≤—ã–∑–æ–≤–æ–≤

---

## üö® –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á–∏—Ç—å `filter_threshold` —Å 1.7 –¥–æ 2.0
2. –°–º—è–≥—á–∏—Ç—å `filter_prompt` (—É–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–≥–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏)
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: –∫–∞–∫–∏–µ score –ø–æ–ª—É—á–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –æ—Ñ—Ç–æ–ø–∏–∫
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç—å `filter_threshold` –¥–æ 1.5
2. –£—Å–∏–ª–∏—Ç—å `filter_prompt` (–¥–æ–±–∞–≤–∏—Ç—å —è–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã)
3. –£–º–µ–Ω—å—à–∏—Ç—å `output_threshold` (—Å—Ç—Ä–æ–∂–µ –æ—Ü–µ–Ω–∫–∞)

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á–∏—Ç—å `operator_threshold` –¥–æ 0.85-0.9
2. –£–ª—É—á—à–∏—Ç—å `persona_prompt` (–±–æ–ª—å—à–µ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö)
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑—É –∑–Ω–∞–Ω–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
**–†–µ—à–µ–Ω–∏–µ:**
1. –£–º–µ–Ω—å—à–∏—Ç—å `top_n` –∏ `top_m` –¥–æ 30-40
2. –£–º–µ–Ω—å—à–∏—Ç—å `top_n_tokens` –∏ `top_m_tokens` –¥–æ 200
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–µ–≥—á–µ embedding –º–æ–¥–µ–ª—å
4. –í–∫–ª—é—á–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–í—Å–µ–≥–¥–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è!**

–°–æ–∑–¥–∞–π—Ç–µ `tuning_log.md`:
```markdown
## 2025-10-04: –°–º—è–≥—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### –ò–∑–º–µ–Ω–µ–Ω–∏—è
- filter_threshold: 1.7 ‚Üí 2.0
- operator_threshold: 0.8 ‚Üí 0.85

### –ü—Ä–∏—á–∏–Ω–∞
50% –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö IT-–≤–æ–ø—Ä–æ—Å–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏—Å—å —Ñ–∏–ª—å—Ç—Ä–æ–º

### –†–µ–∑—É–ª—å—Ç–∞—Ç
- False Positive Rate: 50% ‚Üí 15%
- False Negative Rate: 2% ‚Üí 5% (–ø—Ä–∏–µ–º–ª–µ–º–æ)
```

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [OpenAI Models](https://platform.openai.com/docs/models)
- [Sentence Transformers](https://www.sbert.net/)
- [Prompt Engineering Guide](https://www.promptingguide.ai/)
- [FAISS Documentation](https://github.com/facebookresearch/faiss)

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–ú–µ–Ω—è–π—Ç–µ –ø–æ –æ–¥–Ω–æ–º—É –ø–∞—Ä–∞–º–µ—Ç—Ä—É –∑–∞ —Ä–∞–∑** - –ª–µ–≥—á–µ –ø–æ–Ω—è—Ç—å –≤–ª–∏—è–Ω–∏–µ
2. **–•—Ä–∞–Ω–∏—Ç–µ –±—ç–∫–∞–ø—ã config.yaml** - —á—Ç–æ–±—ã –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** - –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö
4. **–°–æ–±–∏—Ä–∞–π—Ç–µ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å** - –æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML (–æ—Ç—Å—Ç—É–ø—ã, –¥–≤–æ–µ—Ç–æ—á–∏—è)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `.env` —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f app.log`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏: `echo $LLM_API_KEY`

**–£–¥–∞—á–Ω–æ–≥–æ —Ç—é–Ω–∏–Ω–≥–∞! üöÄ**
